<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:微软雅黑;
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:仿宋_GB2312;}
@font-face
	{font-family:"\@微软雅黑";
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@仿宋_GB2312";}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
h1
	{mso-style-link:"标题 1 Char";
	margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";}
h1.CxSpFirst
	{mso-style-link:"标题 1 Char";
	margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";}
h1.CxSpMiddle
	{mso-style-link:"标题 1 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";}
h1.CxSpLast
	{mso-style-link:"标题 1 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";}
h2
	{mso-style-link:"标题 2 Char";
	margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:13.0pt;
	font-family:"Cambria","serif";}
h3
	{mso-style-link:"标题 3 Char";
	margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:112%;
	font-size:10.0pt;
	font-family:"Cambria","serif";}
h4
	{mso-style-link:"标题 4 Char";
	margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:10.0pt;
	font-family:"Cambria","serif";
	font-style:italic;}
h5
	{mso-style-link:"标题 5 Char";
	margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:10.0pt;
	font-family:"Cambria","serif";
	color:#7F7F7F;}
h6
	{mso-style-link:"标题 6 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:112%;
	font-size:10.0pt;
	font-family:"Cambria","serif";
	color:#7F7F7F;
	font-style:italic;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-link:"标题 7 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:10.0pt;
	font-family:"Cambria","serif";
	font-style:italic;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-link:"标题 8 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:10.0pt;
	font-family:"Cambria","serif";}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-link:"标题 9 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:10.0pt;
	font-family:"Cambria","serif";
	letter-spacing:.25pt;
	font-style:italic;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"页眉 Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	text-align:center;
	layout-grid-mode:char;
	border:none;
	padding:0cm;
	font-size:9.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"页脚 Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"标题 Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	text-align:center;
	border:none;
	padding:0cm;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"标题 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	border:none;
	padding:0cm;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"标题 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	border:none;
	padding:0cm;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"标题 Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	text-align:center;
	border:none;
	padding:0cm;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	letter-spacing:.25pt;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{mso-style-link:"副标题 Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:30.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	letter-spacing:.65pt;
	font-style:italic;}
em
	{letter-spacing:.5pt;
	border:none;
	font-weight:bold;}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{mso-style-link:"无间隔 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:36.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:36.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoQuote, li.MsoQuote, div.MsoQuote
	{mso-style-link:"引用 Char";
	margin-top:10.0pt;
	margin-right:18.0pt;
	margin-bottom:0cm;
	margin-left:18.0pt;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:10.0pt;
	font-family:"Calibri","sans-serif";
	font-style:italic;}
p.MsoIntenseQuote, li.MsoIntenseQuote, div.MsoIntenseQuote
	{mso-style-link:"明显引用 Char";
	margin-top:10.0pt;
	margin-right:57.6pt;
	margin-bottom:14.0pt;
	margin-left:50.4pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:115%;
	border:none;
	padding:0cm;
	font-size:10.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;
	font-style:italic;}
span.MsoSubtleEmphasis
	{font-style:italic;}
span.MsoIntenseEmphasis
	{font-weight:bold;}
span.MsoSubtleReference
	{font-variant:small-caps;}
span.MsoIntenseReference
	{font-variant:small-caps;
	letter-spacing:.25pt;
	text-decoration:underline;}
span.MsoBookTitle
	{font-variant:small-caps;
	letter-spacing:.25pt;
	font-style:italic;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
p.MsoTocHeadingCxSpFirst, li.MsoTocHeadingCxSpFirst, div.MsoTocHeadingCxSpFirst
	{margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
p.MsoTocHeadingCxSpMiddle, li.MsoTocHeadingCxSpMiddle, div.MsoTocHeadingCxSpMiddle
	{margin:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
p.MsoTocHeadingCxSpLast, li.MsoTocHeadingCxSpLast, div.MsoTocHeadingCxSpLast
	{margin:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
span.1Char
	{mso-style-name:"标题 1 Char";
	mso-style-link:"标题 1";
	font-family:"Cambria","serif";
	font-weight:bold;}
span.2Char
	{mso-style-name:"标题 2 Char";
	mso-style-link:"标题 2";
	font-family:"Cambria","serif";
	font-weight:bold;}
span.3Char
	{mso-style-name:"标题 3 Char";
	mso-style-link:"标题 3";
	font-family:"Cambria","serif";
	font-weight:bold;}
span.4Char
	{mso-style-name:"标题 4 Char";
	mso-style-link:"标题 4";
	font-family:"Cambria","serif";
	font-weight:bold;
	font-style:italic;}
span.5Char
	{mso-style-name:"标题 5 Char";
	mso-style-link:"标题 5";
	font-family:"Cambria","serif";
	color:#7F7F7F;
	font-weight:bold;}
span.6Char
	{mso-style-name:"标题 6 Char";
	mso-style-link:"标题 6";
	font-family:"Cambria","serif";
	color:#7F7F7F;
	font-weight:bold;
	font-style:italic;}
span.7Char
	{mso-style-name:"标题 7 Char";
	mso-style-link:"标题 7";
	font-family:"Cambria","serif";
	font-style:italic;}
span.8Char
	{mso-style-name:"标题 8 Char";
	mso-style-link:"标题 8";
	font-family:"Cambria","serif";}
span.9Char
	{mso-style-name:"标题 9 Char";
	mso-style-link:"标题 9";
	font-family:"Cambria","serif";
	letter-spacing:.25pt;
	font-style:italic;}
span.Char
	{mso-style-name:"标题 Char";
	mso-style-link:标题;
	font-family:"Cambria","serif";
	letter-spacing:.25pt;}
span.Char0
	{mso-style-name:"副标题 Char";
	mso-style-link:副标题;
	font-family:"Cambria","serif";
	letter-spacing:.65pt;
	font-style:italic;}
span.Char1
	{mso-style-name:"引用 Char";
	mso-style-link:引用;
	font-style:italic;}
span.Char2
	{mso-style-name:"明显引用 Char";
	mso-style-link:明显引用;
	font-weight:bold;
	font-style:italic;}
span.Char3
	{mso-style-name:"无间隔 Char";
	mso-style-link:无间隔;}
span.Char4
	{mso-style-name:"页眉 Char";
	mso-style-link:页眉;}
span.Char5
	{mso-style-name:"页脚 Char";
	mso-style-link:页脚;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	layout-grid:15.6pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=ZH-CN style='text-justify-trim:punctuation'>

<div class=WordSection1 style='layout-grid:15.6pt'>

<div style='border:none;border-bottom:solid windowtext 1.0pt;padding:0cm 0cm 1.0pt 0cm'>

<p class=MsoTitle><span style='font-family:"微软雅黑","sans-serif"'>资费配置操作手册</span></p>

</div>

<h1 style='margin-top:15.6pt;margin-right:0cm;margin-bottom:15.6pt;margin-left:
26.75pt;text-indent:-26.75pt'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>一、<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"微软雅黑","sans-serif"'>引言</span></h1>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>本手册主要描述资费配置的基本工具的使用方法，界面操作及重要事项。由于使用的工具<span
lang=EN-US>BillingClient</span>工具还有其他功能，且另有操作手册，因此本手册只是对资费配置相关的界面进行描述，与资费不相关的部分不涉及。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>资费由多种规则组成，并靠这些规则的共同作用完成其功能，应该选择那种方式，避免哪些问题都有资费配置规范去界定，本手册不涉及这方面的内容，本手册的重点是在确定需要使用某种技术时，能够在本手册中找到配置方法和重要的资费要素的体现方式。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>在使用本操作手册前，配置人员必须具备计费帐务的基础知识，对目前华为公司开发的<span
lang=EN-US>BOSS</span>系统的架构比较了解，对<span lang=EN-US>BillingClient</span>工具有一定的使用经验。</span></p>

<h1 style='margin-top:15.6pt;margin-right:0cm;margin-bottom:15.6pt;margin-left:
26.75pt;text-indent:-26.75pt'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>二、<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"微软雅黑","sans-serif"'>清单处理规则</span></h1>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>清单的处理主要按照分拣预处理、一次批价、二次批价的过程来进行，分拣预处理与资费相关度不大，主要基础是计费事件定义和其他规则定义。</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-family:"微软雅黑","sans-serif"'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>处理计划定义<span
lang=EN-US>&nbsp;&nbsp; </span></span></h2>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>处理计划（<span
lang=EN-US>PROCESS_SCHEMA</span>）其实就是预处理计划，就是清单的一批规则。一批不仅仅要进行话单批价，首先要做的还是话单格式的标准化和分类。处理计划只定义了计划号（<span
lang=EN-US>PROC_SCHEMA_ID</span>）与名称（<span lang=EN-US>PROC_SCHEMA_NAME</span>），确保计划号唯一即可，一般不能轻易修改现存的计划，否则可能引起话单处理的故障。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>一个处理计划中会包含相当多的子项（<span
lang=EN-US>PROCESSED_EVENT</span>），预处理是需要按照处理顺序（<span lang=EN-US>PROCESS_ORDER</span>）从小到大的运用这些规则，每个子项都有一个适用条件（<span
lang=EN-US>PROCESS_COND,G_PROCESS_COND</span>），如果条件满足，则可以进行转换，如果不满足，则跳过。每条规则只将一种源计费事件（<span
lang=EN-US>SOURCE_EVENT_ID</span>）转换为一种目计费事件（<span lang=EN-US>DEST_EVENT_ID</span>），简要说明一般写在处理说明（<span
lang=EN-US>PROCESS_NAME</span>）中。这些子项真正关键的是引用了预处理规则（<span lang=EN-US>START_STEP_ID</span>），而这些预处理规则是被抽象了出来单独实现的，以让不同处理计划的子项都可以使用。</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-family:"微软雅黑","sans-serif"'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>预处理规则定义</span></h2>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>预处理规则（<span
lang=EN-US>PROCESS_RULE_DEF</span>）比较简单，需要一个唯一的数字作为编号（<span lang=EN-US>PROCESS_STEP_ID</span>），还有名字（<span
lang=EN-US>PROCESS_RULE_NAME</span>）。是否是共用规则（<span lang=EN-US>PROCESS_RULE_TYPE</span>）似乎没什么用，一般不做勾选。源计费事件（<span
lang=EN-US>SOUR_EVENT_ID</span>）与目计费事件（<span lang=EN-US>DEST_EVENT_ID</span>）是必须的，加上规则描述（<span
lang=EN-US>DESCRIPTION</span>）是一种良好的习惯。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>预处理规则真正复杂的是其处理流程（<span
lang=EN-US>PROCESS_FLOW</span>），按照处理步骤（<span lang=EN-US>PROCESS_ORDER</span>）依次执行，当规则适用条件（<span
lang=EN-US>RULE_COND</span>）经过计算后如果结果为真，则使用条件真规则（<span lang=EN-US>IF_RULE_ID</span>）来进行处理；如果结果为假，则使用条件假规则（<span
lang=EN-US>ELSE_RULE_ID</span>）来进行处理。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>注意每个条件真<span
lang=EN-US>/</span>假规则都需要指定类型（<span lang=EN-US>IF_RULE_TYPE</span>、<span
lang=EN-US>ELSE_RULE_TYPE</span>），目前共有<span lang=EN-US>3</span>种类型，一种是另一个处理步骤，则规则就在此表中找即可，一种是值映射规则，则需要运用值映射规则，还有一种是表达式规则，则需要使用表达式规则。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>这些规则的使用请参见本手册相关章节。</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-family:"微软雅黑","sans-serif"'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>值映射规则定义</span></h2>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>值映射是一种方法，可以认为是一种查表，将输入值通过某种方法转换为另一种并输出。主要在清单预处理的时候使用，可以认为是一种数据转换，一般不包含复杂的计算和逻辑判断。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>在处理话单是，可以将原始话单中没有的，灵活地加入进去，并可以做各种属性的变换。注意一个值映射规则定义只对应一个值映射参数维护。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>值映射规则（<span
lang=EN-US>MAPPING_RULE</span>）用数字作为唯一的映射规则编号（<span lang=EN-US>RULE_ID</span>），前台展现时，也可以根据映射规则名称（<span
lang=EN-US>RULE_NAME</span>）来了解规则的作用。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>值映射规则的作用是使用值映射参数（<span
lang=EN-US>MAPPING_ID</span>），将源计费事件的的某个属性转换为目计费事件的某个属性，可以选择两种匹配方式<span
lang=EN-US>(MATCH_METHOD)</span>：“等长精确匹配”、“不精确匹配”，如果是“不精确匹配”，还需要看值映射规则中的匹配方式是怎样的。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>当值映射失败，即找不到匹配的时候，需要做一个标记，这个就是不匹配编码（<span
lang=EN-US>ERROR_CODE</span>）的作用了，一般需要注意这个编码不要和其他的重复了。重复本身并不会造成计费上的问题，但是对以后的分析造成了混淆。<span
lang=EN-US> </span></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>在值映射规则中引用了值映射参数（<span
lang=EN-US>MAPPING_DEF</span>），而值映射参数其实更像是一种查表函数，根据一套参数（源计费事件的某个属性），一张表，<span
lang=EN-US>,</span>一种查找方式，从这张表中找到一条记录。这都需要在值映射参数维护中操作。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>由于参数的数量是不一样的，所以需要定义参数的列表，同样表的结构最好也是变化的，因此也需要定义表的字段列表。实现方式是通过定义源属性数量（<span
lang=EN-US>SOUR_FIELD_COUNT</span>）、源属性定义（<span lang=EN-US>MAPPING_SOUR_DEF</span>）来定义参数格式，通过定义目属性数量（<span
lang=EN-US>DEST_FIELD_COUNT</span>）、目属性定义（<span lang=EN-US>MAPPING_DEST_DEF</span>）来定义查找表的结构。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>在确定了这两套格式后，就可以在查找表（<span
lang=EN-US>MAPPING_LIST</span>）中增加记录了，需要将所有可能的情况都配置进去，注意生效时间与失效时间的准确。这些参数的配置繁琐而重要，需要极大的耐心去完成。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>查找方式（<span
lang=EN-US>MATCH_ORDER</span>）目前有<span lang=EN-US>4</span>种：“二分匹配”、“从头顺序匹配”、“从尾顺序匹配”、“二分最大匹配”。不管采用何种查找方式，仔细全面的测试都是必不可少的。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>还需要注意的是，虽然在<span
lang=EN-US>BillingClient</span>中看到的每个值映射参数的查找表结构是不同的，但实际的查找表（<span lang=EN-US>MAPPING_LIST</span>）的结构并不复杂。多值（字段）其实都拼接在一起存放在同一个字段中，如查找参数都使用逗号连接存放在<span
lang=EN-US>MAPPING_SOUR</span>字段中，查找表的字段也是用逗号连接在一起存放在<span lang=EN-US>MAPPING_DEST</span>中。</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-family:"微软雅黑","sans-serif"'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>表达式规则定义 </span></h2>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>值映射规则仍然无法处理的复杂转换就需要通过表达式规则（<span
lang=EN-US>EXPR_MAPPING_RULE</span>）来处理了，表达式规则是值映射规则的功能扩展，相比而言，表达式规则的结构甚至更简单。表达式规则的子项（<span
lang=EN-US>EXPR_MAPPING_LIST</span>）中详细定义了复杂的使用表达式来进行转换的规则。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>在适用条件（<span
lang=EN-US>EXPR_COND</span>）为真时可以使用此规则，最关键的是表达式类型（<span lang=EN-US>EXPR_TYPE</span>），它说明了源计费属性（<span
lang=EN-US>EXPR</span>）的类型。如表达式类型是常数时，源计费事件属性就是一个常数，这是最简单的情况；如果表达式类型是某个实体，则将这个实体值拷贝到目计费事件属性上即可；如果表达式类型是表达式，则源计费事件属性往往是一个函数表达式，通过计算后才能够得到结果。</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-family:"微软雅黑","sans-serif"'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>话单费用项定义</span></h2>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>话单的类型很多，不仅现在的多，以后会更多，因此必须对话单进行一个层次的几种，话单费用项（<span
lang=EN-US>FEE</span>）就是起这个作用的。其界面 相当简单，需要设定的就是费用编号（<span lang=EN-US>FEE_ID</span>）和费用名称（<span
lang=EN-US>FEE_NAME</span>）。这儿的定义更像一种值映射，虽然其实不是。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>话单费用项是基础配置，主要被其他配置引用。</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-family:"微软雅黑","sans-serif"'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>费率设置</span></h2>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>费率顾名思义就是一个价格，除了费率代码（<span
lang=EN-US>RATECODE</span>）、费率名称（<span lang=EN-US>RATENAME</span>）必不可少外，金额（<span
lang=EN-US>CURRENCY</span>）、单位（<span lang=EN-US>UNITS</span>）、单位种类（<span
lang=EN-US>UNITTYPE</span>）是关键要素，对于是按秒、按分、还是按条，是由单位种类决定的。而取整单位（<span
lang=EN-US>ROUND_UNIT</span>）、取整方法（<span lang=EN-US>ROUND_TYPE</span>）在处理余数是很重要的。计价属性（<span
lang=EN-US>ATTR_CLASS</span>）对具体的计费作用不大，主要是用来进行分类。而币种（<span lang=EN-US>CURRENCYTYPE</span>）、地区（<span
lang=EN-US>REGION</span>）一般都是“人民币”和“全省”。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>费率是基础配置，主要被其他配置引用。</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-family:"微软雅黑","sans-serif"'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>资费模式定义</span></h2>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>最直接引用费率的配置就是资费模式（<span
lang=EN-US>TARIFF_SCHEMA</span>），资费模式主要的作用就是决定如何使用费率，对什么样的话单使用什么样的费率。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>除了资费模式编号（<span
lang=EN-US>TARIFF_SCHEMA_ID</span>）、资费模式名称（<span lang=EN-US>TARIFF_NAME</span>）是用来做区分的外，资费模式类型（<span
lang=EN-US>TARIFF_TYPE</span>）、参数字段定义（<span lang=EN-US>FIELD_DEF</span>）、参数字段定义数（<span
lang=EN-US>FIELD_COUNT</span>）是非常重要的，决定了后续处理的方法。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>计费事件（<span
lang=EN-US>EVENT_ID</span>）是本资费模式适用的话单号，可以不设置。参数字段定义（<span lang=EN-US>FIELD_DEF</span>）、参数字段定义数（<span
lang=EN-US>FIELDCOUNT</span>）类似于值映射规则中的动态方式（<span lang=EN-US>MAPPING_LIST</span>），参数的个数和格式可以动态设定和展示。参数匹配次序（<span
lang=EN-US>MATCH_ORDER</span>）常用的是“从头顺序匹配”，“二分匹配“的情况也很多。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>匹配类型（<span
lang=EN-US>MATCH_TYPE</span>）一般都是等长精确匹配，不精确匹配也有，比较少。应用时时间判断方法（<span lang=EN-US>APPLY_METHOD</span>）一般都使用“按计费事件的发生时间匹配“，这样可以较好的处理采集延迟的话单。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>资费标记位置（<span
lang=EN-US>REFID</span>）是一个可以允许扩展的配置，作用是在计费事件上进心标记。每个计费事件都会定义一个费用标志（<span
lang=EN-US>TARIFF_FLAG</span>）字段，一般是长度是<span lang=EN-US>15</span>位的字符串。资费标记位置即使得资费模式可以访问这一位，类似于一种位运算。在其他场景下可以有不同的用途。不过一定要注意，相互间的配置不要干扰。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>剩下的优惠费用（<span
lang=EN-US>DISCOUNT_FEE_ID</span>）、取整方法（<span lang=EN-US>ROUND_METHOD</span>）、取整精度（<span
lang=EN-US>ROUND_SCALE</span>）、帐目编码取值顺序（<span lang=EN-US>BILLCODE_ORDER</span>）、地区（<span
lang=EN-US>REGION</span>）一般都设置成一样的，分别为“空值”、“不控制精度”、“<span lang=EN-US>0</span>”、“取最先处理的”、“全省”。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>资费模式真正复杂的变化都体现在资费模式类型（<span
lang=EN-US>TARIFF_TYPE</span>）上，共有<span lang=EN-US>8</span>种，各自作用如下：</span></p>

<h3 style='margin-left:43.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-size:11.0pt;line-height:112%;font-family:"微软雅黑","sans-serif"'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:11.0pt;line-height:112%;font-family:"微软雅黑","sans-serif"'>表达式</span></h3>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>资费模式子项（<span
lang=EN-US>TARIFF_ITEM</span>）会有一个“资费定义条件”（<span lang=EN-US>TARIFF_CRITERIA</span>），里面可填入一个表达式，当资费子项的其他通用条件（生效时间、失效时间等）都通过时，需要计算这个表达式的取值，如果为真，则根据下级资费类型（<span
lang=EN-US>SUBTARIFF_TYPE</span>）决定下级资费（<span lang=EN-US>TARIFF_ID</span>），以了解如何计算。下级资费类型可以选择“费率”、“资费模式”、“费用项”、“当前费用项”、“封顶费用项”<span
lang=EN-US>5</span>种，这个类型决定了下级资费（<span lang=EN-US>TARIFF_ID</span>）的用法。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>下级资费还有附加优惠比率（<span
lang=EN-US>RATIO</span>）、优先级（<span lang=EN-US>PRECEDENCE</span>）、动态资费类型（<span
lang=EN-US>IS_DYNAMIC</span>）、参数串（<span lang=EN-US>PARAM_STRING</span>）、资费标记符（<span
lang=EN-US>RATETYPE</span>）、帐目编码（<span lang=EN-US>BILLCODE</span>）等字段，一般变化不大。</span></p>

<h3 style='margin-left:43.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-size:11.0pt;line-height:112%;font-family:"微软雅黑","sans-serif"'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:11.0pt;line-height:112%;font-family:"微软雅黑","sans-serif"'>参数映射</span></h3>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>在这种情况下，资费模式子项的定义、展现方式与值映射类似，参数都是动态的，不同的参数可以配置不同的下级资费，不过大多数下级资费都是费率。在资费配置上，这一层次不应过分复杂。</span></p>

<h3 style='margin-left:43.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-size:11.0pt;line-height:112%;font-family:"微软雅黑","sans-serif"'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:11.0pt;line-height:112%;font-family:"微软雅黑","sans-serif"'>分时段</span></h3>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>分时段时，资费模式子项定义了日期范围、周范围、时间范围（时分秒）、跨时段切换方法、跨时段切换单位共<span
lang=EN-US>5</span>个参数（实际上都写在<span lang=EN-US>TARIFF_CRITERIA</span>字段中）。需要注意的是跨时段切换方法现在有三种“按开始时间”、“跨边界的一个时间单位往前靠”、“跨边界的一个时间单位往后靠”，我们一般采用往前靠的模式。</span></p>

<h3 style='margin-left:43.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-size:11.0pt;line-height:112%;font-family:"微软雅黑","sans-serif"'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:11.0pt;line-height:112%;font-family:"微软雅黑","sans-serif"'>累计</span></h3>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>累计模式其实就是先讲计费事件中的分钟数先累计到一个用户变量中，再根据这个累计值决定选取那种下级资费继续运算。在资费模式的参数字段（<span
lang=EN-US>FIELD_DEF</span>）中会定义一个用户变量作为累积量，这个变量需要在用户资料中存在，且是附加属性（<span
lang=EN-US>SUBSCRIBER_USAGE_ATTR</span>）。在子项中，分段定义累计量的分段值（<span lang=EN-US>TARIFF_CRITERIA</span>），即使各条规则一样，计费时也会按照从低到高的顺序来，注意分段值都是取的小于等于。即大于上一分段值，不大于本分段值，就归属本规则处理。</span></p>

<h3 style='margin-left:43.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-size:11.0pt;line-height:112%;font-family:"微软雅黑","sans-serif"'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:11.0pt;line-height:112%;font-family:"微软雅黑","sans-serif"'>赠送</span></h3>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>赠送模式与累计模式方式类似，但计费是反过来的，累计模式是当话单分钟数达到了某值时开始计费，赠送模式是先送一定数值的分钟数，用完为止。这种模式湖北暂时还没有用起来。</span></p>

<h3 style='margin-left:43.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-size:11.0pt;line-height:112%;font-family:"微软雅黑","sans-serif"'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:11.0pt;line-height:112%;font-family:"微软雅黑","sans-serif"'>按时长可变</span></h3>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>湖北暂时还没有用起来。</span></p>

<h3 style='margin-left:43.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-size:11.0pt;line-height:112%;font-family:"微软雅黑","sans-serif"'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:11.0pt;line-height:112%;font-family:"微软雅黑","sans-serif"'>循环累计</span></h3>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>湖北暂时还没有用起来。</span></p>

<h3 style='margin-left:43.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-size:11.0pt;line-height:112%'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:11.0pt;line-height:112%;font-family:"微软雅黑","sans-serif"'>非初始变长</span></h3>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>湖北暂时还没有用起来。</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-family:"微软雅黑","sans-serif"'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>资费政策定义</span></h2>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>资费政策（<span
lang=EN-US>TARIFF_PLAN</span>）的优惠类型（<span lang=EN-US>PLANTYPE</span>）、定价类型（<span
lang=EN-US>PRICEPLANTYPE</span>）、地区（<span lang=EN-US>REGION</span>）都只是属性，不参与计费。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>在处理计费事件前后可以分别调用优惠前预处理方案（<span
lang=EN-US>PROCESS_BEFORE</span>）、优惠后预处理方案（<span lang=EN-US>PROCESS_AFTER</span>），但最好不要使用，因为通过预处理后的一些中间变量后续资费批价时是读取不到的。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>资费政策上最重要的是两个优先级，即清单优惠优先级（<span
lang=EN-US>PRECEDENCE</span>）、帐单优惠优先级（<span lang=EN-US>PRECEDENCE_ACCDISC</span>），这两个级别的设计很复杂，在此不做详细讨论。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>需要强调一点的是，资费变动历史（<span
lang=EN-US>HISTORY</span>）在每次资费修改的时候都要记录，，可以填写增量变动，也可以全部重写。记录变动历史，包括文号、需求等是一个好的习惯。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>资费政策子项（<span
lang=EN-US>TARIFF_PLAN_ITEM</span>）最重要的是批价原则（<span lang=EN-US>SELECT_METHOD</span>）、计费条件（<span
lang=EN-US>CHARGE_COND</span>）和要计算的费用（<span lang=EN-US>FEE_ID</span>）。批价原则有“取较低费用“、”无条件取本费用“、”有条件取本费用“，”空值“这几种。注意”空值“与”有条件取本“是等价的。”有条件取本“的意思是当话单原费用不为<span
lang=EN-US>0</span>时，使用本规则的批价；而计费条件是一个表达式，其中可以引用用户资料、集合、费用组等多种参数；要计算的费用其实就是话单费用项，在合帐时需要用到。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>生效失效判断方法（<span
lang=EN-US>APPLY_METHOD</span>）、计算模式（<span lang=EN-US>DISCOUNT_TYPE</span>）、优惠费用（<span
lang=EN-US>DISCOUNT_FEE_ID</span>）一般变化不大，和同类的保持一致即可。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>资费政策是直接与营业产品相关联的要素，但是这种联系有时过于紧密，特别是在调整优先级时很难处理，因此我们在资费政策与营业资费中间加了一层：产品元素（<span
lang=EN-US>PRODUCT_ELEMENT</span>、<span lang=EN-US>PRODUCT_TARIFF</span>）。并使得产品元素可由多个资费政策组成，营业资费与产品元素对应，这样资费政策的灵活度、复用度都得到了提高。</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-family:"微软雅黑","sans-serif"'>9.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>周期性计费事件生成器定义</span></h2>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>虽然这个菜单是在帐单菜单下的，但由于其作用主要是产生固定费清单，所以我们还是将其归入了清单处理规则中来。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>每个用户，没有实际网络通话或其他行为时，帐务系统还是要每天计算他的套餐固定费的，这种固定费的计算是根据用户的套餐订购关系生成一种叫做“固定费”的计费事件，并由相关的资费来进行批价，最终合帐完成的。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>每天都需要做的一种周期性的任务，其任务是在此处定义的，主要定义了地区、用户号段、启动时间等。还需要考虑上次费用的情况。</span></p>

<h1 style='margin-top:15.6pt;margin-right:0cm;margin-bottom:15.6pt;margin-left:
26.75pt;text-indent:-26.75pt'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>三、<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"微软雅黑","sans-serif"'>帐单处理规则</span></h1>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-family:"微软雅黑","sans-serif"'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>帐单费用代码 </span></h2>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>每条话单在合帐时，都会对应到多个帐单费用上去，而帐单费用也是需要定义的，且帐单费用间的关系更为复杂。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>除了帐单项代码（<span
lang=EN-US>ITEMCODE</span>），名称（<span lang=EN-US>ITEMNAME</span>）外，我们还需要定义帐单项（<span
lang=EN-US>ACCTITEM_DEF</span>）的级别（<span lang=EN-US>ITEMLEVEL</span>）<span
lang=EN-US>,</span>不过这个一般用不上。千万不要忘记配置帐单项的上级（<span lang=EN-US>PARENTITEMCODE</span>）。这在帐单项归并的时候是很有用的。</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-family:"微软雅黑","sans-serif"'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>科目代码定义 </span></h2>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>科目（<span
lang=EN-US>SUBJECT_DEF</span>），是用户存在帐本中的金额的不同类型（<span lang=EN-US>SUBJECTID</span>）<span
lang=EN-US>,</span>科目最总要的属性一般有销帐顺序（<span lang=EN-US>DRAW_ORDER</span>）、批扣范围（<span
lang=EN-US>OFFSET_SCOPE</span>）、有效周期（<span lang=EN-US>AVAILABLE_CYCLE</span>）、可退类型等。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>科目在帐务上的作用主要就是参与信控和缴费销帐，信控的作用其实是一种模拟销帐，总的来说科目本省的特性对销帐影响比较大的都是专款。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>我们一般遵循一下编号规则：</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:43.0pt;margin-bottom:.0001pt;text-indent:-21.0pt;line-height:150%'><span
lang=EN-US style='font-family:Wingdings'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>账单编号<span
lang=EN-US>1</span>开头属于功能费月租型的费用项目</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:43.0pt;margin-bottom:.0001pt;text-indent:-21.0pt;line-height:150%'><span
lang=EN-US style='font-family:Wingdings'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>账单编号<span
lang=EN-US>2</span>开头属于基本通话费类型的费用项目</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:43.0pt;margin-bottom:.0001pt;text-indent:-21.0pt;line-height:150%'><span
lang=EN-US style='font-family:Wingdings'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>账单编号<span
lang=EN-US>3</span>开头属于长途费用项目</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:43.0pt;margin-bottom:.0001pt;text-indent:-21.0pt;line-height:150%'><span
lang=EN-US style='font-family:Wingdings'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>账单编号<span
lang=EN-US>4</span>开头属于漫游费用项目</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:43.0pt;margin-bottom:.0001pt;text-indent:-21.0pt;line-height:150%'><span
lang=EN-US style='font-family:Wingdings'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>账单编号<span
lang=EN-US>5</span>开头属于短信及梦网等费用项目</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:43.0pt;margin-bottom:.0001pt;text-indent:-21.0pt;line-height:150%'><span
lang=EN-US style='font-family:Wingdings'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>账单编号<span
lang=EN-US>6</span>开头属于彩信、彩铃、下载等各种增值业务费用项目</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:43.0pt;margin-bottom:.0001pt;text-indent:-21.0pt;line-height:150%'><span
lang=EN-US style='font-family:Wingdings'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>账单编号<span
lang=EN-US>7</span>开头属于各地气象台及捐款等费用项目</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:43.0pt;margin-bottom:.0001pt;text-indent:-21.0pt;line-height:150%'><span
lang=EN-US style='font-family:Wingdings'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>账单编号<span
lang=EN-US>8</span>开头属于其他费及费用调整项目</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:43.0pt;margin-bottom:.0001pt;text-indent:-21.0pt;line-height:150%'><span
lang=EN-US style='font-family:Wingdings'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>账单编号<span
lang=EN-US>9</span>开头属于参考的话单数、时长、流量等项目</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-family:"微软雅黑","sans-serif"'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>费用组定义</span></h2>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>费用组其实就是多个帐单费用项的组合（<span
lang=EN-US>FEE_GROUP_DEF</span>），主要用于表达式判断上，也可用于其他需要整体出现的地方。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>使用费用组必须非常小心，一定要对现有的费用组的作用非常了解才不会出现乱配费用组的情况。<span
lang=EN-US> </span></span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-family:"微软雅黑","sans-serif"'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>合帐定义</span></h2>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>合帐的作用是将计费事件通过批价生成的话单费用项变成帐目项。合帐的关键配置有两个，一个是合帐条件，很多条件设置在别的地方，仅仅分析观察合帐是无法了解全面的合帐规则的。</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>另一个关键之处是帐目表达式类型（<span
lang=EN-US>EXPR_TYPE</span>）<span lang=EN-US>,</span>其值共有两种：“计费事件表达式”与“计费事件字段”，其实都是针对计费事件的条件。</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt'><span lang=EN-US
style='font-family:"微软雅黑","sans-serif"'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"微软雅黑","sans-serif"'>帐务优惠定义 </span></h2>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:"微软雅黑","sans-serif"'>帐务优惠就是帐单级优惠，与清单级优惠的差异在于帐务优惠是针对帐目项进行操作的，并且优惠规则更将就顺序。</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:"微软雅黑","sans-serif"'>帐务优惠可以有多条，每条规则简单地说就是对优惠项目（<span
lang=EN-US>DISC_ITEMCODE</span>）在满足计费条件（<span lang=EN-US>DISC_COND</span>）时，应用一套优惠计算规则（<span
lang=EN-US>DISCITEM_DEF</span>）。在这个计算中，可以实现打折、保底、分段计算等多种方式的计费。</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:"微软雅黑","sans-serif"'>帐务优惠的变量比较多：</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:"微软雅黑","sans-serif"'>优惠项目<span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; target
</span>（<span lang=EN-US> target0 </span>是旧值<span lang=EN-US> target1 </span>是新值
）</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:"微软雅黑","sans-serif"'>优惠参考项目<span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; refer</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:"微软雅黑","sans-serif"'>参考量增加值<span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:"微软雅黑","sans-serif"'>参考量下限<span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; limit_floor</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:"微软雅黑","sans-serif"'>参考量上限<span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; limit_ceil</span></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>优惠量<span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; disc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;
</span>（<span lang=EN-US> disc0 </span>是初值<span lang=EN-US> disc1 </span>是终值 ）</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:"微软雅黑","sans-serif"'>优惠量条件<span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; condition</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:"微软雅黑","sans-serif"'>优惠量上限<span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; disc_ceil</span></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>计算方式比较复杂，主要有以下<span
lang=EN-US>6</span>种：</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>A</span><span
style='font-family:"微软雅黑","sans-serif"'>、固定值</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; disc1
= -disc0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-family:"微软雅黑","sans-serif"'>注意啊，固定值意味着帐务优惠后<span lang=EN-US>
target1 = disc0</span></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>B</span><span
style='font-family:"微软雅黑","sans-serif"'>、参考量百分比</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; disc1
= ( refer + inc ) * ( disc0 / 100 )</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>C</span><span
style='font-family:"微软雅黑","sans-serif"'>、参考量相对值</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; disc1
= ( refer + inc ) - disc0;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>D</span><span
style='font-family:"微软雅黑","sans-serif"'>、下级资费</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; disc1
</span><span style='font-family:"微软雅黑","sans-serif"'>等于<span lang=EN-US> disc0 </span>所表示的帐务优惠的<span
lang=EN-US> disc1</span></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>E</span><span
style='font-family:"微软雅黑","sans-serif"'>、费率</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; disc1
= ( refer + inc ) * ( disc0 / 1000 )</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>F</span><span
style='font-family:"微软雅黑","sans-serif"'>、表达式计算</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; disc1
= expr(disc0)</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>综合运用以上<span
lang=EN-US>6</span>种方式，可以实现很多变化，如保底、打折、赠送、收取等等。</span></p>

<h1 style='margin-top:15.6pt;margin-right:0cm;margin-bottom:15.6pt;margin-left:
26.75pt;text-indent:-26.75pt'><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'>四、<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"微软雅黑","sans-serif"'>小结</span></h1>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
22.0pt;line-height:150%'><span style='font-family:"微软雅黑","sans-serif"'>资费包含有多重规则，单个规则就已经比较复杂了，多个规则综合作用下，单个资费就更复杂，多个资费叠加作用后，影响就更加的广泛了。为了有效控制资费配置的风险，不仅仅要在各项规则配置时采用合理规范的方法，还需要根据各种规则间的制约关系，开发集成化的软件来对资费进行一体化的管理，这也是资费配置规范的目标。</span></p>

</div>

</body>

</html>
